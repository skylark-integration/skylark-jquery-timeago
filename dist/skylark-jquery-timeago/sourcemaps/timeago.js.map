{"version":3,"sources":["timeago.js"],"names":["define","$","timeago","timestamp","Date","inWords","parse","datetime","$t","extend","settings","refreshMillis","allowPast","allowFuture","localeTitle","cutoff","autoDispose","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","inPast","seconds","minute","minutes","hour","hours","day","days","month","months","year","years","wordSeparator","numbers","distanceMillis","this","$l","prefix","suffix","Math","abs","substitute","stringOrFunction","number","string","isFunction","value","replace","words","round","separator","undefined","trim","join","iso8601","s","elem","isTime","attr","get","tagName","toLowerCase","functions","init","dispose","call","refresh_el","proxy","refresh","$s","_timeagoInterval","setInterval","update","date","data","toLocaleString","apply","updateFromDOM","window","clearInterval","contains","document","documentElement","element","text","length","prepareData","isNaN","distance","getTime","fn","action","options","Error","each","createElement"],"mappings":"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","file":"../timeago.js","sourcesContent":["define([\"skylark-jquery\"],function ($) {\n  $.timeago = function(timestamp) {\n    if (timestamp instanceof Date) {\n      return inWords(timestamp);\n    } else if (typeof timestamp === \"string\") {\n      return inWords($.timeago.parse(timestamp));\n    } else if (typeof timestamp === \"number\") {\n      return inWords(new Date(timestamp));\n    } else {\n      return inWords($.timeago.datetime(timestamp));\n    }\n  };\n  var $t = $.timeago;\n\n  $.extend($.timeago, {\n    settings: {\n      refreshMillis: 60000,\n      allowPast: true,\n      allowFuture: false,\n      localeTitle: false,\n      cutoff: 0,\n      autoDispose: true,\n      strings: {\n        prefixAgo: null,\n        prefixFromNow: null,\n        suffixAgo: \"ago\",\n        suffixFromNow: \"from now\",\n        inPast: 'any moment now',\n        seconds: \"less than a minute\",\n        minute: \"about a minute\",\n        minutes: \"%d minutes\",\n        hour: \"about an hour\",\n        hours: \"about %d hours\",\n        day: \"a day\",\n        days: \"%d days\",\n        month: \"about a month\",\n        months: \"%d months\",\n        year: \"about a year\",\n        years: \"%d years\",\n        wordSeparator: \" \",\n        numbers: []\n      }\n    },\n\n    inWords: function(distanceMillis) {\n      if (!this.settings.allowPast && ! this.settings.allowFuture) {\n          throw 'timeago allowPast and allowFuture settings can not both be set to false.';\n      }\n\n      var $l = this.settings.strings;\n      var prefix = $l.prefixAgo;\n      var suffix = $l.suffixAgo;\n      if (this.settings.allowFuture) {\n        if (distanceMillis < 0) {\n          prefix = $l.prefixFromNow;\n          suffix = $l.suffixFromNow;\n        }\n      }\n\n      if (!this.settings.allowPast && distanceMillis >= 0) {\n        return this.settings.strings.inPast;\n      }\n\n      var seconds = Math.abs(distanceMillis) / 1000;\n      var minutes = seconds / 60;\n      var hours = minutes / 60;\n      var days = hours / 24;\n      var years = days / 365;\n\n      function substitute(stringOrFunction, number) {\n        var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\n        var value = ($l.numbers && $l.numbers[number]) || number;\n        return string.replace(/%d/i, value);\n      }\n\n      var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\n        seconds < 90 && substitute($l.minute, 1) ||\n        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\n        minutes < 90 && substitute($l.hour, 1) ||\n        hours < 24 && substitute($l.hours, Math.round(hours)) ||\n        hours < 42 && substitute($l.day, 1) ||\n        days < 30 && substitute($l.days, Math.round(days)) ||\n        days < 45 && substitute($l.month, 1) ||\n        days < 365 && substitute($l.months, Math.round(days / 30)) ||\n        years < 1.5 && substitute($l.year, 1) ||\n        substitute($l.years, Math.round(years));\n\n      var separator = $l.wordSeparator || \"\";\n      if ($l.wordSeparator === undefined) { separator = \" \"; }\n      return $.trim([prefix, words, suffix].join(separator));\n    },\n\n    parse: function(iso8601) {\n      var s = $.trim(iso8601);\n      s = s.replace(/\\.\\d+/,\"\"); // remove milliseconds\n      s = s.replace(/-/,\"/\").replace(/-/,\"/\");\n      s = s.replace(/T/,\" \").replace(/Z/,\" UTC\");\n      s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/,\" $1$2\"); // -04:00 -> -0400\n      s = s.replace(/([\\+\\-]\\d\\d)$/,\" $100\"); // +09 -> +0900\n      return new Date(s);\n    },\n    datetime: function(elem) {\n      var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\n      return $t.parse(iso8601);\n    },\n    isTime: function(elem) {\n      // jQuery's `is()` doesn't play well with HTML5 in IE\n      return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\n    }\n  });\n\n  // functions that can be called via $(el).timeago('action')\n  // init is default when no action is given\n  // functions are called with context of a single element\n  var functions = {\n    init: function() {\n      functions.dispose.call(this);\n      var refresh_el = $.proxy(refresh, this);\n      refresh_el();\n      var $s = $t.settings;\n      if ($s.refreshMillis > 0) {\n        this._timeagoInterval = setInterval(refresh_el, $s.refreshMillis);\n      }\n    },\n    update: function(timestamp) {\n      var date = (timestamp instanceof Date) ? timestamp : $t.parse(timestamp);\n      $(this).data('timeago', { datetime: date });\n      if ($t.settings.localeTitle) {\n        $(this).attr(\"title\", date.toLocaleString());\n      }\n      refresh.apply(this);\n    },\n    updateFromDOM: function() {\n      $(this).data('timeago', { datetime: $t.parse( $t.isTime(this) ? $(this).attr(\"datetime\") : $(this).attr(\"title\") ) });\n      refresh.apply(this);\n    },\n    dispose: function () {\n      if (this._timeagoInterval) {\n        window.clearInterval(this._timeagoInterval);\n        this._timeagoInterval = null;\n      }\n    }\n  };\n\n  $.fn.timeago = function(action, options) {\n    var fn = action ? functions[action] : functions.init;\n    if (!fn) {\n      throw new Error(\"Unknown function name '\"+ action +\"' for timeago\");\n    }\n    // each over objects here and call the requested function\n    this.each(function() {\n      fn.call(this, options);\n    });\n    return this;\n  };\n\n  function refresh() {\n    var $s = $t.settings;\n\n    //check if it's still visible\n    if ($s.autoDispose && !$.contains(document.documentElement,this)) {\n      //stop if it has been removed\n      $(this).timeago(\"dispose\");\n      return this;\n    }\n\n    var data = prepareData(this);\n\n    if (!isNaN(data.datetime)) {\n      if ( $s.cutoff === 0 || Math.abs(distance(data.datetime)) < $s.cutoff) {\n        $(this).text(inWords(data.datetime));\n      } else {\n        if ($(this).attr('title').length > 0) {\n            $(this).text($(this).attr('title'));\n        }\n      }\n    }\n    return this;\n  }\n\n  function prepareData(element) {\n    element = $(element);\n    if (!element.data(\"timeago\")) {\n      element.data(\"timeago\", { datetime: $t.datetime(element) });\n      var text = $.trim(element.text());\n      if ($t.settings.localeTitle) {\n        element.attr(\"title\", element.data('timeago').datetime.toLocaleString());\n      } else if (text.length > 0 && !($t.isTime(element) && element.attr(\"title\"))) {\n        element.attr(\"title\", text);\n      }\n    }\n    return element.data(\"timeago\");\n  }\n\n  function inWords(date) {\n    return $t.inWords(distance(date));\n  }\n\n  function distance(date) {\n    return (new Date().getTime() - date.getTime());\n  }\n\n  // fix for IE6 suckage\n  document.createElement(\"abbr\");\n  document.createElement(\"time\");\n});\n"]}