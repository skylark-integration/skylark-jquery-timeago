{"version":3,"sources":["skylark-jquery-timeago.js"],"names":["define","$","timeago","timestamp","Date","inWords","parse","datetime","$t","extend","settings","refreshMillis","allowPast","allowFuture","localeTitle","cutoff","autoDispose","showTimeOnFull","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","inPast","seconds","minute","minutes","hour","hours","day","days","month","months","year","years","wordSeparator","numbers","distanceMillis","this","$l","prefix","suffix","Math","abs","substitute","stringOrFunction","number","string","isFunction","value","replace","words","round","separator","undefined","trim","join","iso8601","s","elem","isTime","attr","get","tagName","toLowerCase","functions","init","dispose","call","refresh_el","proxy","refresh","$s","_timeagoInterval","setInterval","update","date","data","toLocaleString","apply","updateFromDOM","window","clearInterval","contains","document","documentElement","element","text","length","prepareData","isNaN","distance","txt","split","getTime","fn","action","options","Error","each","createElement","jQuery","main"],"mappings":"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","file":"../skylark-jquery-timeago.js","sourcesContent":["define('skylark-jquery-timeago/timeago',[\"skylark-jquery\"],function ($) {\n  $.timeago = function(timestamp) {\n    if (timestamp instanceof Date) {\n      return inWords(timestamp);\n    } else if (typeof timestamp === \"string\") {\n      return inWords($.timeago.parse(timestamp));\n    } else if (typeof timestamp === \"number\") {\n      return inWords(new Date(timestamp));\n    } else {\n      return inWords($.timeago.datetime(timestamp));\n    }\n  };\n  var $t = $.timeago;\n\n  $.extend($.timeago, {\n    settings: {\n      refreshMillis: 60000,\n      allowPast: true,\n      allowFuture: false,\n      localeTitle: false,\n      cutoff: 0,\n      autoDispose: true,\n      showTimeOnFull : false,\n      strings: {\n        prefixAgo: null,\n        prefixFromNow: null,\n        suffixAgo: \"ago\",\n        suffixFromNow: \"from now\",\n        inPast: 'any moment now',\n        seconds: \"less than a minute\",\n        minute: \"about a minute\",\n        minutes: \"%d minutes\",\n        hour: \"about an hour\",\n        hours: \"about %d hours\",\n        day: \"a day\",\n        days: \"%d days\",\n        month: \"about a month\",\n        months: \"%d months\",\n        year: \"about a year\",\n        years: \"%d years\",\n        wordSeparator: \" \",\n        numbers: []\n      }\n    },\n\n    inWords: function(distanceMillis) {\n      if (!this.settings.allowPast && ! this.settings.allowFuture) {\n          throw 'timeago allowPast and allowFuture settings can not both be set to false.';\n      }\n\n      var $l = this.settings.strings;\n      var prefix = $l.prefixAgo;\n      var suffix = $l.suffixAgo;\n      if (this.settings.allowFuture) {\n        if (distanceMillis < 0) {\n          prefix = $l.prefixFromNow;\n          suffix = $l.suffixFromNow;\n        }\n      }\n\n      if (!this.settings.allowPast && distanceMillis >= 0) {\n        return this.settings.strings.inPast;\n      }\n\n      var seconds = Math.abs(distanceMillis) / 1000;\n      var minutes = seconds / 60;\n      var hours = minutes / 60;\n      var days = hours / 24;\n      var years = days / 365;\n\n      function substitute(stringOrFunction, number) {\n        var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\n        var value = ($l.numbers && $l.numbers[number]) || number;\n        return string.replace(/%d/i, value);\n      }\n\n      var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\n        seconds < 90 && substitute($l.minute, 1) ||\n        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\n        minutes < 90 && substitute($l.hour, 1) ||\n        hours < 24 && substitute($l.hours, Math.round(hours)) ||\n        hours < 42 && substitute($l.day, 1) ||\n        days < 30 && substitute($l.days, Math.round(days)) ||\n        days < 45 && substitute($l.month, 1) ||\n        days < 365 && substitute($l.months, Math.round(days / 30)) ||\n        years < 1.5 && substitute($l.year, 1) ||\n        substitute($l.years, Math.round(years));\n\n      var separator = $l.wordSeparator || \"\";\n      if ($l.wordSeparator === undefined) { separator = \" \"; }\n      return $.trim([prefix, words, suffix].join(separator));\n    },\n\n    parse: function(iso8601) {\n      var s = $.trim(iso8601);\n      s = s.replace(/\\.\\d+/,\"\"); // remove milliseconds\n      s = s.replace(/-/,\"/\").replace(/-/,\"/\");\n      s = s.replace(/T/,\" \").replace(/Z/,\" UTC\");\n      s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/,\" $1$2\"); // -04:00 -> -0400\n      s = s.replace(/([\\+\\-]\\d\\d)$/,\" $100\"); // +09 -> +0900\n      return new Date(s);\n    },\n    datetime: function(elem) {\n      var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\n      return $t.parse(iso8601);\n    },\n    isTime: function(elem) {\n      // jQuery's `is()` doesn't play well with HTML5 in IE\n      return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\n    }\n  });\n\n  // functions that can be called via $(el).timeago('action')\n  // init is default when no action is given\n  // functions are called with context of a single element\n  var functions = {\n    init: function() {\n      functions.dispose.call(this);\n      var refresh_el = $.proxy(refresh, this);\n      refresh_el();\n      var $s = $t.settings;\n      if ($s.refreshMillis > 0) {\n        this._timeagoInterval = setInterval(refresh_el, $s.refreshMillis);\n      }\n    },\n    update: function(timestamp) {\n      var date = (timestamp instanceof Date) ? timestamp : $t.parse(timestamp);\n      $(this).data('timeago', { datetime: date });\n      if ($t.settings.localeTitle) {\n        $(this).attr(\"title\", date.toLocaleString());\n      }\n      refresh.apply(this);\n    },\n    updateFromDOM: function() {\n      $(this).data('timeago', { datetime: $t.parse( $t.isTime(this) ? $(this).attr(\"datetime\") : $(this).attr(\"title\") ) });\n      refresh.apply(this);\n    },\n    dispose: function () {\n      if (this._timeagoInterval) {\n        window.clearInterval(this._timeagoInterval);\n        this._timeagoInterval = null;\n      }\n    }\n  };\n\n  $.fn.timeago = function(action, options) {\n    var fn = action ? functions[action] : functions.init;\n    if (!fn) {\n      throw new Error(\"Unknown function name '\"+ action +\"' for timeago\");\n    }\n    // each over objects here and call the requested function\n    this.each(function() {\n      fn.call(this, options);\n    });\n    return this;\n  };\n\n  function refresh() {\n    var $s = $t.settings;\n\n    //check if it's still visible\n    if ($s.autoDispose && !$.contains(document.documentElement,this)) {\n      //stop if it has been removed\n      $(this).timeago(\"dispose\");\n      return this;\n    }\n\n    var data = prepareData(this);\n\n    if (!isNaN(data.datetime)) {\n      if ( $s.cutoff === 0 || Math.abs(distance(data.datetime)) < $s.cutoff) {\n        $(this).text(inWords(data.datetime));\n      } else {\n        if ($(this).attr('title').length > 0) {\n            var txt = $(this).attr('title');\n            if (!$s.showTimeOnFull) {\n              txt = txt.split(\" \")[0];\n            }\n            $(this).text(txt);\n        }\n      }\n    }\n    return this;\n  }\n\n  function prepareData(element) {\n    element = $(element);\n    if (!element.data(\"timeago\")) {\n      element.data(\"timeago\", { datetime: $t.datetime(element) });\n      var text = $.trim(element.text());\n      if ($t.settings.localeTitle) {\n        element.attr(\"title\", element.data('timeago').datetime.toLocaleString());\n      } else if (text.length > 0 && !($t.isTime(element) && element.attr(\"title\"))) {\n        element.attr(\"title\", text);\n      }\n    }\n    return element.data(\"timeago\");\n  }\n\n  function inWords(date) {\n    return $t.inWords(distance(date));\n  }\n\n  function distance(date) {\n    return (new Date().getTime() - date.getTime());\n  }\n\n  // fix for IE6 suckage\n  document.createElement(\"abbr\");\n  document.createElement(\"time\");\n});\n\ndefine('skylark-jquery-timeago/locales/en',[\"skylark-jquery\",\"../timeago\"],function (jQuery) {\n  // English (Template)\n  jQuery.timeago.settings.strings = {\n    prefixAgo: null,\n    prefixFromNow: null,\n    suffixAgo: \"ago\",\n    suffixFromNow: \"from now\",\n    seconds: \"less than a minute\",\n    minute: \"about a minute\",\n    minutes: \"%d minutes\",\n    hour: \"about an hour\",\n    hours: \"about %d hours\",\n    day: \"a day\",\n    days: \"%d days\",\n    month: \"about a month\",\n    months: \"%d months\",\n    year: \"about a year\",\n    years: \"%d years\",\n    wordSeparator: \" \",\n    numbers: []\n  };\n});\n\ndefine('skylark-jquery-timeago/locales/ja',[\"skylark-jquery\",\"../timeago\"],function (jQuery) {\n  // Japanese\n  jQuery.timeago.settings.strings = {\n    prefixAgo: \"\",\n    prefixFromNow: \"今から\",\n    suffixAgo: \"前\",\n    suffixFromNow: \"後\",\n    seconds: \"1 分未満\",\n    minute: \"約 1 分\",\n    minutes: \"%d 分\",\n    hour: \"約 1 時間\",\n    hours: \"約 %d 時間\",\n    day: \"約 1 日\",\n    days: \"約 %d 日\",\n    month: \"約 1 ヶ月\",\n    months: \"約 %d ヶ月\",\n    year: \"約 1 年\",\n    years: \"約 %d 年\",\n    wordSeparator: \"\"\n  };\n});\n\ndefine('skylark-jquery-timeago/locales/zh-CN',[\"skylark-jquery\",\"../timeago\"],function (jQuery) {\n  // Simplified Chinese\n  jQuery.timeago.settings.strings = {\n    prefixAgo: null,\n    prefixFromNow: null,\n    suffixAgo: \"之前\",\n    suffixFromNow: \"之后\",\n    seconds: \"不到1分钟\",\n    minute: \"大约1分钟\",\n    minutes: \"%d分钟\",\n    hour: \"大约1小时\",\n    hours: \"大约%d小时\",\n    day: \"1天\",\n    days: \"%d天\",\n    month: \"大约1个月\",\n    months: \"%d月\",\n    year: \"大约1年\",\n    years: \"%d年\",\n    numbers: [],\n    wordSeparator: \"\"\n  };\n});\n\n\ndefine('skylark-jquery-timeago/main',[\r\n\t\"./timeago\",\r\n\t\"./locales/en\",\r\n\t\"./locales/ja\",\r\n\t\"./locales/zh-CN\"\r\n],function(){\r\n\r\n});\ndefine('skylark-jquery-timeago', ['skylark-jquery-timeago/main'], function (main) { return main; });\n\n"]}